\documentclass[a4paper,11pt,DIV=11,BROC=5mm,bigheadings,idxtotoc,cleardoubleempty,halfparskip,oneside,openright]{scrreprt} % 

\usepackage{datetime}

\usepackage{graphicx}
\usepackage{xcolor}

\usepackage{blindtext}

\usepackage{cite}% Zitieren
\usepackage{bibgerm}% Literatur in Deutscher DIN
\usepackage{url}


\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{listings}

\usepackage[utf8]{inputenc}
\usepackage{lmodern}

\usepackage{microtype}


\usepackage{scrpage2} 	% Kopf & Fußzeile im KOMA Stil
\pagestyle{scrheadings}	% Aktiviert Verwendung vordefinierter Kolumnentitel
\clearscrheadfoot 		% alle Standard-Werte und Formatierungen löschen
\setkomafont{pagehead}{\scshape}	% Schriftart in Kopfzeile, \scshape = Kapitelchen
\automark[chapter]{section} % [linke Seite]{rechte Seite}
%\ohead{\def\pagestyle{PDTS}{\hrulefill\includegraphics[width = 6cm]{bilder/thi_logo_quer_cropped}}}
\ohead{\includegraphics[width = 6cm]{bilder/thi_logo_quer_cropped}}

%\ihead{\textsc{Abschlussarbeit}}
\ihead{\headmark}

%\setheadwidth[0pt]{textwithmarginpar}
\ofoot{\vspace{-0.3cm} \pagemark} 						
\ifoot{\vspace{-0.3cm} Dominik Gunther Florian Schlecht} 
				
%\setheadtopline{2pt}				
%\setheadsepline{.4pt}
\setfootsepline{.4pt}	% Trennlinie Fußzeile und Textkörper

%-------------------------------------------------------------






%------------------------------------------------------------------
%% Längenanpassungen
%------------------------------------------------------------------

\setlength{\headsep}{10mm}				% Textabstand zur Kopfzeile
\setlength{\footskip}{15mm}				% Abstand zur Fußzeile
\setlength{\parindent}{0em}				% Einzug nach Absatz

%------------------------------------------------------------------
%% THI - Farbdefinitionen
%------------------------------------------------------------------

% Farben der THI
\definecolor{THIblue}{rgb}{0.0078,0.1176,0.4705}
%%-------------Allgemeine Definitionen----------------------------------
% Farbige Aufwertung der berschriften
\addtokomafont{chapter}{\color{THIblue}}
\addtokomafont{section}{\color{THIblue}}
\addtokomafont{caption}{\color{THIblue}}
\addtokomafont{subsection}{\color{THIblue}}
\addtokomafont{subsubsection}{\color{THIblue}}
\setkomafont{captionlabel}{\color{THIblue}}

%------------------------------------------------------------------
%% Interessante optinale Packages
%------------------------------------------------------------------

% -> Verlinkter Text im PDF
	\usepackage[
			pdftex,
			linkcolor=THIblue,			% Farbe der Verlinkung
			linktocpage=true,			% Im TOC wird Seitenzahl verlinkt(true),bzw. Text(false)
			colorlinks=true,			% 'true' keinen Kasten um Link
	%		citecolor=blue,
	%		pdfhighlight=/P,
	%		bookmarks,
	%		hyperfigures=true,
	%		citebordercolor={0 0 1},
	%		linkbordercolor={0 0 1},
	%		menubordercolor={0 0 1},
	%		backref=true,
	%		pagebackref=true,
	%%		bookmarksopen,
	%		bookmarksnumbered,
	%		pdfpagelabels=false,
	%		pdfstartpage=1,
	%		pdfstartview=Fit,			% Modus beim Öffnen (Fit = An Seitengröße anpassen)
			pdftitle={Umgehen von PID und VID basierten USB-Policies},
			pdfauthor={Dominik Schlecht},
	%		pdfstartview=Fit,
	%		pdfdisplaydoctitle=true,
	%		plainpages=false
				]{hyperref}  



%------------------------------------------------------------------
%% Wichtige Definition für Aufteilung von Formelverzeichnis und Abkürzungsverzeichnis
%------------------------------------------------------------------

% Nomenklaturverzeichnis, Formelzeichenliste Anpassungen für nomenclature: damit lassen sich zwei getrennte Symbolverzeichnisse anlegen, ziehmlich cool!
\usepackage[intoc,compatible,german]{nomencl}	
		\renewcommand{\nomgroup}[1]{	\ifthenelse{\equal{#1}{A}}{\item[{\normalfont\sffamily\bfseries\LARGE\textcolor[rgb]{0,0.112,0.47}{Abkürzungen{\phantom{\Huge $\frac{\frac{\frac{A}{a}}{a}}{\frac{a}{a}}$}}}}]}{	\ifthenelse{\equal{#1}{A}}{\item[{\normalfont\sffamily\bfseries\LARGE\textcolor[rgb]{0,0.112,0.47}{Formelzeichen{\phantom{\Huge $\frac{A}{\frac{a}{a}}$}}}}]}{}}}
		
%% z.B. (1)  \nomenclature{$v_0$}{Startgeschwindigkeit}   -> Formelverzeichnis
\nomenclature[A]{SAF}{Security Awareness Framework}



%------------------------------------------------------------------
%% Anpassung von Abständen, Längen vom Nomenclaturverzeichnis (Abkürzungs- und Formelverzeichnis)
%------------------------------------------------------------------

		% Abstand zwischen Einträgen im Symbolverzeichnis (-\parsep = 0)
		\setlength{\nomitemsep}{-\parsep} 
		\setlength{\nomlabelwidth}{5em}	
		\renewcommand{\nomlabel}[1]{#1 \dotfill}  % Punkte im zwischen Nummer und Kapiteleintrag






%------------------------------------------------------------------
%% Definition Standardordner der Bilddatein für schnellen Zugriff
%------------------------------------------------------------------
%
%\newcommand\figpfad{bilder/}
%


%%-------------Silbentrennung--------------------------------------
\hyphenation{}

%%-------------Index-----------------------------------------------
\makeindex
\makenomenclature

%------------------------------------------------------------------
% Angabe der zu verwendenden Dateien, sodass nur z.B. das aktuelle 
% Dokument compiliert wird; den Rest mit % auskommentieren
		\includeonly{%
			chapter/title_page,%
			chapter/thanks_statement,
            chapter/einleitung,
			chapter/appendix%
		}


%------------------------------------------------------------------------

%-----------------------------------------------------------------
%---------------Dokumentenbeginn----------------------------------
%-----------------------------------------------------------------
	\begin{document}
			
			\include{chapter/title_page}			
				\cleardoublepage

			\include{chapter/thanks_statement}
				\cleardoublepage	
					
			% Inhaltsverzeichnis
			%\setcounter{\secnumdepth}{2} % Zwei Ebenen im Inhaltsverzeichnis auflisten
			\tableofcontents
				\cleardoublepage	
		
			% Abkrzungsverzeichnis
			\printnomenclature
				\cleardoublepage	
			
%------------------------------------------------------------------------
			% Neunummerierung des Hauptteils
			\pagenumbering{arabic}
			\setcounter{page}{1}            
            \cleardoublepage
            
            \include{chapter/einleitung}
                \cleardoublepage
                
			\chapter{Motivation}
Bei einer Prüfung interner Regularien bei der Informationssicherheit wurde das Thema USB-Geräte in Verbindung mit Thin oder auch sogenannten Zero-Clients aufgegriffen. Hier soll aus gegeben fachlichen Anlässen eine Möglichkeit geschaffen werden lokale USB-Geräte, wie z.B. USB-Sticks oder USB-CD-Laufwerke, an die virtuelle Maschine des Benutzers durch zu stellen. Hier galt es das Risiko zu Prüfen und entsprechende Gegenmaßnahmen zu entwicklen. Würde man das Durchstellen von USB-Geräten jedoch im Allgemeinen erlauben, so würden sich erheblich Gefahren ergeben, welche unter \ref{AllgGefBeiUSB} erläutert werden. Um dem Vorzubeigen, soll auf Basis einer Policie, welche in \ref{Policies} weiter erläutert werden, das Durchstellen auf bestimmte Geräte begrenzt werden. Dies geschieht im normalfall über die Filterung nach PID und VID, welche eine Produkt, z.B. einen bestimmten USB-Stick, eindeutig Identifiezieren sollten. Diese Felder werden unter \ref{FelderUSB} weiter erläutert. Bei der durchgeführten Sicherheitsprüfung stellte sich jedoch heraus, dass diese Filterung durch die Fälschung der PID und VID leicht gefälscht werden können. Der Angriff, \ref{Angriff}, soll in diesem Dokument erläuter und Aufgezeigt werden. Den Proof-Of-Concept finden Sie untern \ref{PoC}.
		
			\chapter{Allgemeine Gefahren bei USB}\label{AllgGefBeiUSB}
USB-Geräte stellen Gefahren auf verschiedenen Ebenen dar. Zum einen werden USB-Sticks, zumindest in dem Szenario, das hier betrachtet wurde, von Dritten an Mitarbeiter gegeben. Das heist, dass der Dritte, insofern dieser die nötige kriminielle Energie aufweist, ein prepariertes Gerät einschicken könnte. Erschwerend kommt hinzu, dass der Mitarbeiter keine Möglichkeit hat, ein böses USB-Gerät von einem normalen zu unterscheiden. Auch besteht die Möglichkeit für den Dritten den Angriff über längerere Zeit vorzubereiten, da kein Zeitdruck besteht, im Gegenteil, USB-Geräte sind gerade noch im Aufwärtstrend. TODO CD vs USB Statistik. Bei der Manipulation sind verschiedene Szenarien denkbar. Einige sind in den nächsten Sektionen aufgeführt.

			\section{Viren}
Viren sind eine wachsende Bedrohung in der heutigen Zeit. Vor einigen Jahren waren einige wenige Virenfamilien weit verbreitet. So konnten Virenhersteller über signaturbasierte Suchalgorithmen nach bekannten Mustern suchen und Viren identifizieren. In den letzten Jahren zeichnet sich jedoch der Trend ab, dass Viren sich schneller weiterentwickeln und zudem oft polymorph programmiert sind, also ihr aussehen bei einer Infektion verändern. Dadurch werden signaturbasierte Erkennungen immer uneffizienter und die Gefahr, dass ein Rechner unerkannt Infiziert wird, steigt. Eine Infektion passiert zumeist über sogenannte Browserexploits, also preparierte Webseiten, welche Lücken in der Software des Users nutzten, oder durch E-Mails verbreitet. In dem von uns betrachteten Szenario würde ein krimineller Dritter oder aber auch ein unwissinder Dritter, dessen Rechner von einem Virus infiziert ist, einen USB-Stick mit einem Virus einschicken. Dabei wird im folgenden zwischen Viren im ursprünglichen Sinn und Viren, welche sich auf der Treiberebene einnissten, unterschieden.

			\subsection{Normale Viren}
			\subsection{Viren auf Treiberebene und neue Möglichkeiten durch Virtualisierungsumgebungen}

			\section{Dateneinschleußung}

			
			\section{Datenabfluss}
Neben den Gefahren von außen müssen jedoch auch sogenannte \glqq Inside-Threaths\grqq beachtet werden. Dies wären Mitarbeiter, welche z.B. interne IT-Systeme manipulieren, um sich Vorteile oder Reichtümer zu verschaffen. Das wohl bekannteste Beispiel wäre hier wohl ein TODO Kevin Midnick Geschichte. Bezogen auf USB wäre ein Risiko der Abfluss von Daten, also wenn ein Mitarbeiter Daten auf einem USB-Stick speichert und diese mit nach Hause nimmt, um diese zu Verkaufen oder sich zu bereichern. Denkbar wären zum Beispiel Kundendaten, bei Admins Passwörter, Geschäftsberichte oder sonstige Unternehmensgeheimnisse. Diese können oft für Geld in einschlägigen Bereichen des Internets verkauft oder bei Geschäftsberichten zur Manipulation am Finanzmarkt genutzt werden. Auch wäre eine Abwerbung eines Mitarbeiters von einem anderen Unternehmen für Industriespionage denkbar.
Eine neue Bedrohung sind Geheimdienste, welche Personen in eine Unternehmen einschleußen oder Mitarbeiter abwerben, um Daten übe die Kunden zu sammeln. Dies wurde erst letztens durch von Edward Snowden veröffentlichte Dokumente publik. TODO Quelle

			\chapter{Policies} \label{Policies}
Policies sind Regelwerke, welche in IT-Systemen, aber auch als interne Regelungen in Unternehmen zum Einsatz kommen. TODO
						
			
			\chapter{Felder bei USB} \label{FelderUSB}
			\section{Allgemein}
			\section{PID}
			\section{VID}
			
			\chapter{Umgehung der Policies}\label{Angriff}
			\section{Teensy}
			\section{Vorgehen}
			\section{Proof of Concept} \label{PoC}

			\chapter{Ausblick in die Zukunft}			
			
			\chapter{Gegenmaßnahmen}
	
			
%------------------------------------------------------------------------
			
			% Anhang
			\include{chapter/appendix}
			
			% Literaturliste
			\newpage
			\bibliographystyle{plaindin}	% DIN Norm für Literaturdarstellung
			\bibliography{ref/ref_liste}	% Pfad und Datei der Ref-Datenbank
		
	\end{document}
%-----------------------------------------------------------------
